<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>登录</title>
    <link rel="stylesheet" href="/static/css/wechatapp.css">
    <script type="text/javascript" src="/static/js/jquery-3.4.1.min.js"></script>
    <script type='text/javascript'>

        $(function () {
            $("#validateCode").keyup(function () {
                checkLoginValidateCode($(this).val());
            });

        });

        function uploadLoginValidateCode() {
            $("#loginValidateCode").attr("src", "/loginValidateCode?random=" + new Date().getMilliseconds());
        }

        function checkLoginValidateCode(validateCode) {
            var error = $("#validateCode").parent().next();
            if (validateCode != null && validateCode != "") {
                $.ajax({
                    type: "POST",
                    async: false,
                    url: "/checkLoginValidateCode?validateCode=" + validateCode,
                    success: function (json) {
                        if (json != null && json.code == 200 && json.status != null) {
                            if (json.status == true) {
                            } else if (json.status == false) {
                            } else {
                                uploadLoginValidateCode();
                            }
                        }
                        return false;
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert("服务器错误！状态码：" + XMLHttpRequest.status);
                        // 状态
                        console.log(XMLHttpRequest.readyState);
                        // 错误信息
                        console.log(textStatus);
                        return false;
                    }
                });
            } else {
            }
        }

    </script>
    <script src="/static/js/bootstrap.js"></script>
    <script src="/static/js/index.js"></script>

</head>
<body>
<div class="indexbox">
    <div class="statediv">
        <h3>南阳理工学院 / 软件学院</h3>
        <h5>欢迎使用 南工校园管理平台</h5>
        <p> @ 一个微信商城开发平台，能快速开发一个商城</p>
        <p> @ 使用当下最流行的Spring Boot+Mybatis+Shiro+J2Cache技术</p>
        <p> @ 友好的代码结构及注释，便于阅读及二次开发</p>
        <p> @ 完善的XSS防范及脚本过滤，彻底杜绝XSS攻击</p>
        <p> @ 日志分级输出，便于分析日志</p>
        <p> @ 前端使用Vue+iView，上手容易</p>
        <p> @ 创作人:焦洋、张怡馨、李鑫淼、邓胜涛</p>
        <p> @ Git：https://github.com/Z-Jiao/WeChatApp.git</p>
        <p> @ JavaDoc：</p>
    </div>
    <div class="logindiv">
        <form action="/index" method="post">
            <p>登录综合管理平台</p>
            <p></p>
            <div id="logindiv-input">
                <p th:text="${error}"></p>
                <input type="text" class="studentId" name="studentId" placeholder="工号/学号"> <br>
                <input type="password" placeholder="密码" class="password" name="password"/>
            </div>
            <div id="logindiv-code">
                <input type="text" placeholder="验证码" id="validateCode" name="validateCode"/>
                <div class="imgdiv">
                    <img id="loginValidateCode" style="cursor: pointer;" src="/loginValidateCode" onclick="uploadLoginValidateCode();">
                </div>

            </div>
            <button type="submit"><span>登录</span></button>
        </form>
    </div>
</div>
<div class="indexbox2">
    <div class="statediv2">
        <h2>微同商城 / 安徽微同科技有限公司</h2>
        <p>欢迎使用 微同开源商城管理平台</p>
    </div>
    <div class="logindiv-far">
        <div class="logindiv">
            <form action="/index" method="post">
                <p>登录综合管理平台</p>
                <p></p>
                <div id="logindiv-input">
                    <input type="text" class="studentId" name="studentId" placeholder="工号/学号"> <br>
                    <input type="password" placeholder="密码" class="password" name="password"/>
                </div>
                <div id="logindiv-code">
                    <input type="text" placeholder="验证码" id="validateCode" name="validateCode"/>
                    <div class="imgdiv">
                        <img id="loginValidateCode" style="cursor: pointer;" src="/loginValidateCode" onclick="uploadLoginValidateCode();">
                    </div>

                </div>
                <button type="submit"><span>登录</span></button>
            </form>
        </div>
    </div>

</div>
</body>
</html>