<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>登录</title>
    <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
    <script type='text/javascript'>

        $(function () {
            $("#validateCode").keyup(function () {
                checkLoginValidateCode($(this).val());
            });

        });

        function uploadLoginValidateCode() {
            $("#loginValidateCode").attr("src", "/loginValidateCode?random=" + new Date().getMilliseconds());
        }


        function checkLoginValidateCode(validateCode) {
            var error = $("#validateCode").parent().next();
            if (validateCode != null && validateCode != "") {
                $.ajax({
                    type: "POST",
                    async: false,
                    url: "/checkLoginValidateCode?validateCode=" + validateCode,
                    success: function (json) {
                        if (json != null && json.code == 200 && json.status != null) {
                            if (json.status == true) {
                            } else if (json.status == false) {
                            } else {
                                uploadLoginValidateCode();
                            }
                        }
                        return false;
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert("服务器错误！状态码：" + XMLHttpRequest.status);
                        // 状态
                        console.log(XMLHttpRequest.readyState);
                        // 错误信息
                        console.log(textStatus);
                        return false;
                    }
                });
            } else {
            }
        }

    </script>
    <link rel="stylesheet" href="/css/wechatapp.css">
</head>
<body>

<div class="indexbox">
    <div class="statediv">
        <h3>微同商城 / 安徽微同科技有限公司</h3>
        <h5>欢迎使用 微同开源商城管理平台</h5>
        <p> @ 一个微信商城开发平台，能快速开发一个商城</p>
        <p> @ 使用当下最流行的Spring+SpringMVC+Mybatis+Shiro+J2Cache技术</p>
        <p> @ 友好的代码结构及注释，便于阅读及二次开发</p>
        <p> @ 完善的XSS防范及脚本过滤，彻底杜绝XSS攻击</p>
        <p> @ 日志分级输出，便于分析日志</p>
        <p> @ 前端使用Vue+iView，上手容易</p>
        <p> @ 官方QQ群：66502035(微同科技1群) 870579539(微同科技2群) 151602347(微同科技3群)</p>
        <p> @ Git：https://gitee.com/fuyang_lipengjun/platform</p>
        <p> @ JavaDoc：https://apidoc.gitee.com/fuyang_lipengjun/platform</p>
    </div>
    <div class="logindiv">
        <form action="/index" method="post">
            <p>登录综合管理平台</p>
            <div id="logindiv-input">
                <input type="text" class="studentId" name="studentId" placeholder="工号/学号"> <br>
                <input type="password" placeholder="密码" class="password" name="password"/>
            </div>
            <div id="logindiv-code">
                <input type="text" placeholder="验证码" id="validateCode" name="validateCode"/>
                <div class="imgdiv">
                    <img id="loginValidateCode" style="cursor: pointer;" src="/loginValidateCode" onclick="uploadLoginValidateCode();">
                </div>

            </div>

            <button type="submit"><span>登录</span></button>
        </form>
    </div>
</div>


</body>
</html>